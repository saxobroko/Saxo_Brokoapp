<html>
<head>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat&amp;display=swap" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css" type="text/css">
<style>*{margin: 0; padding: 0; box-sizing: border-box;}body{width: 100%; height: 100vh; overflow: hidden; display: flex; justify-content: center; align-items: center; font-family: Montserrat, sans-serif; background: radial-gradient(#e74c3c 4px, transparent 4px), radial-gradient(#e74c3c 4px, transparent 4px), linear-gradient(#222 4px, transparent 0), linear-gradient(45deg, transparent 74px, transparent 75px, #3498db 75px, #3498db 76px, transparent 77px, transparent 109px), linear-gradient(-45deg, transparent 75px, transparent 76px, #3498db 76px, #3498db 77px, transparent 78px, transparent 109px), #222; background-size: 109px 109px, 109px 109px, 100% 6px, 109px 109px, 109px 109px; background-position: 54px 55px, 0px 0px, 0px 0px, 0px 0px, 0px 0px;}.highlight{font-weight: 900;}.highlight._1{color: #3498db;}.highlight._2{color: #e74c3c;}.highlight._3{color: #21c758;}.retry-text{position: absolute; top: 38%; pointer-events: none; user-select: none;}.retry-text .char{font-size: 12vmin; font-weight: 800; letter-spacing: 5px;}.retry-text .char::before{pointer-events: none; content: attr(data-char); position: absolute; visibility: visible; color: #fff; transition: all 200ms cubic-bezier(0.1, 0.1, 0.33, 1); transition-delay: calc(0.16s + (0.03s * (var(--char-index))));}.char{overflow: hidden; color: transparent;}.hide .char::before{transform: translateY(50%); opacity: 0;}.show .char::before{transform: translateY(0); opacity: 1;}.retry-btn{position: absolute; top: 58%; background: transparent; font-size: 1.1em; border: none; outline: none; color: #fff; width: 120px; height: 50px; border: 2px solid rgba(255, 255, 255, 0.6); cursor: pointer; transition: all 180ms cubic-bezier(0.075, 0.82, 0.165, 1); user-select: none;}.retry-btn.hide{pointer-events: none; opacity: 0;}.retry-btn.show .char{color: #fff;}.retry-btn:hover{background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(2px);}.retry-btn .char{font-size: 0.9em; font-weight: 900;}.retry-btn:focus{outline: none;}.start-screen{position: absolute; background: rgba(0, 0, 0, 0.45); backdrop-filter: blur(20px); width: 450px; height: 250px; padding: 10px; display: flex; flex-direction: column; transition: all 300ms cubic-bezier(0.075, 0.82, 0.165, 1);}.start-screen.hide{opacity: 0; transform: translateY(100%); pointer-events: none; z-index: -1;}.start-screen .game-data{width: 100%; height: 30%; display: flex; justify-content: center; align-items: center;}.start-screen .game-data .name{font-size: 2rem; color: #fff; font-weight: 900; text-transform: uppercase; letter-spacing: 6px;}.start-screen .game-data .name span:nth-child(1){color: #3498db;}.start-screen .game-data .name span:nth-child(2){color: #e74c3c;}.start-screen .info{width: 100%; height: 50%; padding: 5px 10px; font-size: 14px; line-height: 20px; color: rgba(255, 255, 255, 0.7);}.start-screen .btn.play{position: relative; width: 120px; height: 50px; border: none; border: 2px solid rgba(255, 255, 255, 0.6); cursor: pointer; letter-spacing: 2px; font-weight: 900; background: none; color: #fff; align-self: center; margin-top: -10px; transition: all 400ms cubic-bezier(0.8, 0, 0.33, 1); overflow: hidden;}.start-screen .btn.play::after, .start-screen .btn.play::before{position: absolute; width: 100%; transition: all 400ms cubic-bezier(0.8, 0, 0.33, 1); z-index: -1;}.start-screen .btn.play::before{content: ""; height: 0%; left: 0; bottom: 0; border-radius: 50% 50% 0 0; background: #fff;}.start-screen .btn.play::after{content: "PLAY"; height: 180%; right: 0; top: 0; color: #000; transform: translateY(-100%); font-size: 1.4em;}.start-screen .btn.play:hover{color: transparent; border-color: #fff;}.start-screen .btn.play:hover::after{transform: translateY(15%);}.start-screen .btn.play:hover::before{height: 180%;}.start-screen .btn.play:focus{transform: scale(0.9); outline: none;}.support{position: absolute; right: 5px; bottom: 5px; padding: 5px; display: flex;}a{margin: 0 15px; color: #fff; font-size: 1.8rem; transition: all 400ms ease;}a:hover{opacity: 0.6;}</style>
</head>
<body>
<div class="start-screen">
	<div class="game-data">
		<span class="name"><span>Color</span> <span>Collision</span></span>
	</div>
	<span class="info">
		<span class="highlight _1">FOCUS</span> is the weapon.
		Don't make the wrong move.
		Tap / click to change the color and save the central balls.
		Because if the central balls don't stay alive <span class="highlight _2">YOU DIE</span>.
		Better play <span class="highlight _3">SAFE</span> and make a new highscore.
	</span>
	<button class="btn play">PLAY</button>
</div>

<span class="retry-text hide" data-splitting>Game Over!</span>
<button class="retry-btn hide" data-splitting>RETRY</button>
<canvas data-canvas></canvas>


<div class="support">
	<a href="https://twitter.com/DevLoop01" target="_blank"><i class="fab fa-twitter-square"></i></a>
	<a href="https://github.com/devloop01/color-collision" target="_blank"><i class="fab fa-github"></i></a>
</div>
<script src="https://unpkg.com/splitting/dist/splitting.min.js"></script>
<script>function randomFloatFromRange(min, max){return (Math.random() * (max - min + 1) + min);}function randomFromArray(arr){return arr[Math.floor(Math.random() * arr.length)]}function getDist(x1, y1, x2, y2){return Math.sqrt(Math.pow((x2 - x1), 2) + Math.pow((y2 - y1), 2))}class Particle{constructor(canvas, ctx, x, y, radius, color, velX, velY){this.canvas=canvasthis.ctx=ctxthis.x=xthis.y=ythis.velocity={x: (Math.random() - 0.5) * velX,y: (Math.random() - 0.5) * velY,}this.radius=radiusthis.color=colorthis.timeToLive=250this.opacity=1this.gravity=0.25}draw(){this.ctx.save()this.ctx.beginPath()this.ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false)this.ctx.fillStyle=this.colorthis.ctx.shadowColor=this.colorthis.shadowBlur=25this.ctx.globalAlpha=this.opacitythis.ctx.fill()this.ctx.closePath()this.ctx.restore()}update(){this.x +=this.velocity.xthis.y +=this.velocity.ythis.velocity.y +=this.gravitythis.timeToLive -=1this.opacity -=1 / this.timeToLivethis.draw()}}class Ball{constructor(canvas, ctx, x, y, radius, color, particlesArr, velX, velY, dontCheck){this.canvas=canvasthis.ctx=ctxthis.x=xthis.y=ythis.radius=radiusthis.color=colorthis.velocity={x: velX || 0,y: velY || 0}this.acc=0.01this.origin={x: x, y: y}this.dontCheck=dontCheckthis.opacity=1this.particlesArr=particlesArrthis.collided=false}draw(){this.ctx.save()this.ctx.beginPath()this.ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false)this.ctx.fillStyle=this.colorthis.ctx.shadowColor=this.colorthis.shadowBlur=25this.ctx.shadowOffsetX=0;this.ctx.shadowOffsetY=0;this.ctx.globalAlpha=this.opacitythis.ctx.fill()this.ctx.closePath()this.ctx.restore()}update(ballsArr, updateVel=false){if(this.origin.y <=0){this.y +=this.velocity.y}else if(this.origin.y >=this.canvas.height){this.y -=this.velocity.y}if(updateVel==true){this.y +=this.velocity.ythis.x +=this.velocity.x}this.collisionDetect(ballsArr)this.draw()}collisionDetect(ballsArr){for(let i=0; i < ballsArr.length; i++){if(this===ballsArr[i] || this.dontCheck) continuelet distBetweenPoints=getDist(this.x, this.y, ballsArr[i].x, ballsArr[i].y) - this.radius * 2if(distBetweenPoints < 0){if(this.color==ballsArr[i].color){for(let j=0; j < Math.floor(randomFloatFromRange(20, 25)); j++){this.break(this.particlesArr, 0.4, 0.8)this.collided=true}this.opacity=0}else if(this.color !=ballsArr[i].color){for(let j=0; j < Math.floor(randomFloatFromRange(40, 55)); j++){ballsArr.forEach((ball)=>{ball.opacity=0this.break(this.particlesArr, 2, 5, ball.x, ball.y, ball.color)})this.particlesArr.forEach((particle)=>{particle.gravity=0})}}}}}edgeDetect(){if (this.y + this.radius + this.velocity.y > this.canvas.height){this.velocity.y *=-1}else if(this.y - this.radius <=0){this.velocity.y *=-1}if (this.x + this.radius + this.velocity.x > this.canvas.width){this.velocity.x *=-1}else if (this.x - this.radius <=0){this.velocity.x *=-1}}break(arr, minRadius, maxRadius, x, y, c){var randRadius=randomFloatFromRange(minRadius, maxRadius)var randVel={x: randomFloatFromRange(-20, 20),y: randomFloatFromRange(-20, 20),}if(this.origin.y <=0){let spawnX , spawnYlet colorif(x && y){spawnX=xspawnY=ycolor=c}else{spawnX=this.xspawnY=this.y + this.radiuscolor=this.color}arr.push(new Particle(this.canvas, this.ctx,spawnX, spawnY,randRadius, color , randVel.x, randVel.y))}else{let spawnX , spawnYlet colorif(x && y){spawnX=xspawnY=ycolor=c}else{spawnX=this.xspawnY=this.y - this.radiuscolor=this.color}arr.push(new Particle(this.canvas, this.ctx,spawnX, spawnY,randRadius, color , randVel.x, randVel.y))}}change(colorDefault, colorTochange){if(this.color !=colorDefault){this.color=colorDefault}else{this.color=colorTochange}}}Splitting()const canvas=document.querySelector('[data-canvas]')const ctx=canvas.getContext('2d')let canvasHeight=innerHeight - 50, canvasWidth=400canvas.width=canvasWidthcanvas.height=canvasHeightvar retryBtn=document.querySelector('.retry-btn')var retryText=document.querySelector('.retry-text')var playBtn=document.querySelector('.btn.play')var startScreen=document.querySelector('.start-screen')let balls=[], particles=[]var redBall, blueBall var separation=35 var globalRadius=18 let generateBall=false let timeIntervallet velocityOfBalllet failed=false let timer=0 let score=0 let fillColor var colors=['#e74c3c', '#3498db']var randPoints=[{x: canvas.width / 2,y: -50},{x: canvas.width / 2,y: canvas.height + 50}]function init(){balls=[]particles=[]uselessBalls=[]generateBall=truetimeInterval=2000timer=0velocityOfBall=2.5score=0fillColor='#fff'blueBall=new Ball(canvas, ctx,canvasWidth/2, canvasHeight/2 - separation,globalRadius, colors[1], particles, 0, 0, true)redBall=new Ball(canvas, ctx,canvasWidth/2, canvasHeight/2 + separation,globalRadius, colors[0], particles, 0, 0, true)balls.push(redBall, blueBall)}var uselessBalls=[]function initUseless(){for(let i=0; i < 20; i++){let randVelXY={x: randomFloatFromRange(-5, 5),y: randomFloatFromRange(-5, 5)}let r=randomFloatFromRange(5, 10)uselessBalls.push(new Ball(canvas, ctx, canvasWidth / 2, canvasHeight / 2,r, colors[Math.floor(Math.random() * colors.length)],particles, randVelXY.x, randVelXY.y, true))}balls.push([...uselessBalls])}initUseless()var background=BG_Gradient('#2c3e50', '#34495e')function loop(){requestAnimationFrame(loop)ctx.fillStyle=backgroundctx.fillRect(0, 0, canvas.width, canvas.height)ctx.fillStyle=fillColorctx.font='21px sans-serif'ctx.fillText(`SCORE : ${score.toString()}`, 20, 35)uselessBalls.forEach(ball=>{ball.update(balls, true)ball.edgeDetect()})if(uselessBalls.length !=0){return}if(balls.length !=0){balls.forEach((ball, index)=>{ball.update(balls)if(ball.collided==true){score +=10fillColor=ball.color}if(ball.opacity <=0){ball.dontCheck=trueballs.splice(index, 1)}})}if(balls.length==0 || balls.length==1){failed=truegenerateBall=false}if(balls.length==2){generateBall=true}if(timeInterval % timer==0 && generateBall==true){generateBall=falsepushNewBalls()}if(particles.length !=0){particles.forEach((particle, index)=>{particle.update()if(particle.opacity <=0.05){particles.splice(index, 1)}})}if(timer==600){timer=0}showHideOptions()timer++}loop()function pushNewBalls(){var randomPoint=randomFromArray(randPoints), randomColor=randomFromArray(colors)balls.push(new Ball(canvas, ctx,randomPoint.x, randomPoint.y,globalRadius, randomColor, particles, 0, velocityOfBall, false))}function showHideOptions(){if(failed==true && generateBall==false){retryText.classList.remove('hide')retryText.classList.add('show')retryBtn.classList.remove('hide')retryBtn.classList.add('show')}else if(failed==false && generateBall==true){retryText.classList.add('hide')retryText.classList.remove('show')retryBtn.classList.add('hide')retryBtn.classList.remove('show')}}function BG_Gradient(color1, color2){let bg=ctx.createLinearGradient(0, 0, canvasWidth, canvasHeight)bg.addColorStop(0, color1)bg.addColorStop(1, color2)return bg}setInterval(()=>{if(velocityOfBall <=7){velocityOfBall +=0.08}else{velocityOfBall +=0}}, 1500)canvas.addEventListener('mousedown', ()=>{redBall.change(colors[0], colors[1])blueBall.change(colors[1], colors[0])})retryBtn.addEventListener('mousedown', ()=>{failed=falseinit()})playBtn.addEventListener('mousedown', ()=>{startScreen.classList.add('hide')init()})window.addEventListener('resize', ()=>{canvasHeight=innerHeight - 50canvas.height=canvasHeight})</script>
</body>
</html>